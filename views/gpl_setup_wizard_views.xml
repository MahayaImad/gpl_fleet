<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!-- Vue formulaire pour l'assistant de configuration -->
    <record id="view_gpl_setup_wizard_form" model="ir.ui.view">
        <field name="name">gpl.setup.wizard.form</field>
        <field name="model">gpl.setup.wizard</field>
        <field name="arch" type="xml">
            <form string="Assistant de Configuration GPL">
                <header>
                    <field name="step" widget="statusbar"
                           statusbar_visible="welcome,company_info,technicians,products,settings,complete"/>
                </header>

                <sheet>
                    <field name="step" invisible="1"/>

                    <!-- √âTAPE 1: BIENVENUE -->
                    <div invisible="step != 'welcome'">
                        <div class="oe_title text-center">
                            <h1><i class="fa fa-fire text-primary" title =" " /> Configuration GPL</h1>
                            <p class="lead">Bienvenue dans l'assistant de configuration du module GPL</p>
                        </div>

                        <div class="alert alert-info text-center"  role="alert">
                            <h4>üöÄ Configurons votre syst√®me GPL en quelques √©tapes !</h4>
                            <p>Cet assistant vous guidera pour :</p>
                            <ul class="list-unstyled">
                                <li>‚úÖ Configurer les informations de votre entreprise</li>
                                <li>‚úÖ Cr√©er vos techniciens GPL</li>
                                <li>‚úÖ D√©finir vos types de r√©servoirs</li>
                                <li>‚úÖ Param√©trer le syst√®me selon vos besoins</li>
                                <li>‚úÖ Cr√©er des donn√©es d'exemple (optionnel)</li>
                            </ul>
                        </div>

                        <div class="text-center mt-4">
                            <p><strong>Dur√©e estim√©e :</strong> 5-10 minutes</p>
                            <p class="text-muted">Vous pourrez modifier ces param√®tres plus tard dans la configuration.</p>
                        </div>
                    </div>

                    <!-- √âTAPE 2: INFORMATIONS ENTREPRISE -->
                    <div invisible="step != 'company_info'">
                        <div class="oe_title">
                            <h1>üè¢ Informations de votre entreprise</h1>
                            <p>Configurez les informations li√©es √† votre activit√© GPL.</p>
                        </div>

                        <group>
                            <group string="Entreprise">
                                <field name="company_name" readonly="1"/>
                                <field name="has_gpl_license"/>
                            </group>
                            <group string="Certification GPL" invisible="has_gpl_license == False">
                                <field name="license_number" required="has_gpl_license == True"/>
                                <field name="certification_authority" placeholder="ex: BUREAU VERITAS"/>
                            </group>
                        </group>

                        <div class="alert alert-warning" invisible="has_gpl_license == True"  role="alert">
                            <strong>‚ö†Ô∏è Attention :</strong> Pour installer des r√©servoirs GPL, vous devez poss√©der
                            les certifications et licences appropri√©es selon la r√©glementation en vigueur.
                        </div>
                    </div>

                    <!-- √âTAPE 3: TECHNICIENS -->
                    <div invisible="step != 'technicians'">
                        <div class="oe_title">
                            <h1>üë®‚Äçüîß Configuration des techniciens</h1>
                            <p>D√©finissez les techniciens qui effectueront les installations GPL.</p>
                        </div>

                        <group>
                            <field name="create_technicians"/>
                        </group>

                        <group invisible="create_technicians == False">
                            <group string="Techniciens √† cr√©er">
                                <field name="technician_names" nolabel="1"/>
                            </group>
                            <group string="Technicien par d√©faut">
                                <field name="default_technician_id"
                                       domain="[('job_title', 'ilike', 'technicien')]"
                                       options="{'no_create': True}"/>
                            </group>
                        </group>

                        <div class="alert alert-info" invisible="create_technicians == False"  role="alert">
                            <strong>üí° Conseil :</strong> Le technicien par d√©faut sera automatiquement
                            assign√© aux nouvelles installations. Vous pourrez le modifier pour chaque installation.
                        </div>
                    </div>

                    <!-- √âTAPE 4: PRODUITS R√âSERVOIRS -->
                    <div invisible="step != 'products'">
                        <div class="oe_title">
                            <h1>üõ¢Ô∏è Types de r√©servoirs GPL</h1>
                            <p>Cr√©ez les produits r√©servoirs que vous installez couramment.</p>
                        </div>

                        <group>
                            <field name="create_sample_products"/>
                        </group>

                        <group invisible="create_sample_products == False">
                            <group string="Types de r√©servoirs √† cr√©er">
                                <field name="reservoir_types" nolabel="1"/>
                            </group>
                        </group>

                        <div class="alert alert-info" invisible="create_sample_products == False"  role="alert">
                            <strong>üìù Format :</strong> Saisissez un type par ligne.
                            Le syst√®me d√©tectera automatiquement la capacit√© (ex: 60L) et la forme (Cylindrique/Toro√Ødal).
                        </div>
                    </div>

                    <!-- √âTAPE 5: PARAM√àTRES -->
                    <div invisible="step != 'settings'">
                        <div class="oe_title">
                            <h1>‚öôÔ∏è Param√®tres du syst√®me</h1>
                            <p>Configurez le comportement du syst√®me selon vos pr√©f√©rences.</p>
                        </div>

                        <group>
                            <group string="Workflow d'installation">
                                <field name="use_simplified_flow"/>
                                <field name="auto_invoice" invisible="use_simplified_flow == False"/>
                            </group>
                            <group string="Gestion des r√©servoirs">
                                <field name="reservoir_validity_years"/>
                                <field name="warning_months"/>
                                <field name="enable_alerts"/>
                            </group>
                        </group>

                        <group>
                            <group string="Donn√©es d'exemple (optionnel)">
                                <field name="create_sample_data"/>
                                <field name="sample_vehicles_count" invisible="create_sample_data == False"/>
                                <field name="sample_reservoirs_count" invisible="create_sample_data == False"/>
                            </group>
                        </group>

                        <div class="alert alert-success"  role="alert">
                            <strong>‚úÖ Flux simplifi√© recommand√© :</strong>
                            Active un workflow optimis√© pour les petites structures
                            (cr√©ation automatique des bons de commande et livraison).
                        </div>
                    </div>

                    <!-- √âTAPE 6: TERMIN√â -->
                    <div invisible="step != 'complete'">
                        <div class="oe_title text-center">
                            <h1><i class="fa fa-check-circle text-success fa-3x" title =" " /></h1>
                            <h1>Configuration termin√©e !</h1>
                            <p class="lead">Votre syst√®me GPL est maintenant pr√™t √† √™tre utilis√©.</p>
                        </div>

                        <div class="alert alert-success"  role="alert">
                            <h4>üìä R√©sum√© de la configuration :</h4>
                            <div class="row">
                                <div class="col-6">
                                    <ul class="list-unstyled">
                                        <li>üë®‚Äçüîß <strong>Techniciens cr√©√©s :</strong> <field name="created_technicians_count" readonly="1"/></li>
                                        <li>üõ¢Ô∏è <strong>Produits cr√©√©s :</strong> <field name="created_products_count" readonly="1"/></li>
                                    </ul>
                                </div>
                                <div class="col-6">
                                    <ul class="list-unstyled">
                                        <li>üöó <strong>V√©hicules d'exemple :</strong> <field name="created_vehicles_count" readonly="1"/></li>
                                        <li>üì¶ <strong>R√©servoirs d'exemple :</strong> <field name="created_reservoirs_count" readonly="1"/></li>
                                    </ul>
                                </div>
                            </div>
                        </div>

                        <div class="text-center mt-4">
                            <h4>üöÄ Prochaines √©tapes :</h4>
                            <div class="row">
                                <div class="col-4">
                                    <div class="card">
                                        <div class="card-body text-center">
                                            <i class="fa fa-car fa-2x text-primary" title =" " />
                                            <h6 class="mt-2">Ajouter des v√©hicules</h6>
                                            <small class="text-muted">Enregistrez vos premiers v√©hicules clients</small>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-4">
                                    <div class="card">
                                        <div class="card-body text-center">
                                            <i class="fa fa-cogs fa-2x text-success" title =" " />
                                            <h6 class="mt-2">Cr√©er une installation</h6>
                                            <small class="text-muted">D√©marrez votre premi√®re installation GPL</small>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-4">
                                    <div class="card">
                                        <div class="card-body text-center">
                                            <i class="fa fa-fire fa-2x text-info" title =" " />
                                            <h6 class="mt-2">G√©rer les r√©servoirs</h6>
                                            <small class="text-muted">Suivez l'√©tat de vos r√©servoirs</small>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </sheet>

                <footer>
                    <!-- Boutons de navigation -->
                    <button string="Pr√©c√©dent"
                            name="action_previous_step"
                            type="object"
                            class="btn-secondary"
                            invisible="step == 'welcome'"/>

                    <button string="Suivant"
                            name="action_next_step"
                            type="object"
                            class="btn-primary"
                            invisible="step == 'complete'"/>

                    <button string="üè† Accueil GPL"
                            name="action_open_dashboard"
                            type="object"
                            class="btn-success"
                            invisible="step != 'complete'"/>

                    <button string="Terminer"
                            name="action_finish_setup"
                            type="object"
                            class="btn-primary"
                            invisible="step != 'complete'"/>

                    <button string="Annuler"
                            class="btn-secondary"
                            special="cancel"/>
                </footer>
            </form>
        </field>
    </record>

    <!-- Action pour l'assistant de configuration -->
    <record id="action_gpl_setup_wizard" model="ir.actions.act_window">
        <field name="name">Assistant de Configuration GPL</field>
        <field name="res_model">gpl.setup.wizard</field>
        <field name="view_mode">form</field>
        <field name="target">new</field>
        <field name="help" type="html">
            <p>
                Utilisez cet assistant pour configurer rapidement votre syst√®me GPL.
                Il vous guidera √† travers toutes les √©tapes n√©cessaires.
            </p>
        </field>
    </record>


</odoo>
